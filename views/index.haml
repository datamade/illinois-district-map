.row-fluid
  .span5
    .well
      %h4
        Find candidates in your district
        <small>(<a id='find_me' href='#'>find me</a>)</small>

      .input-append
        %input#search_address.span8{:placeholder => "Enter an address or an intersection", :type => "text"}
      
        %input#search.btn.btn-primary{:type => "button", :value => "Search"}
        %button#reset.btn Reset

    .well
      #enter_search
        %p
          This is a tool for exploring Illinois Legislative Districts and the 
          candidates that run in them.
        %p
          Enter an address above to get started.
      #results{:style => 'display:none;'}
        %h4.map-both 
          %span#candidatesCountboth
          candidates stayed in your district
        #candidatesListboth.candidate-list
        %hr
        
        %h4.map-2011
          %span#candidatesCount2011
          candidates only in 2011 House District:
          %span#district2011_results
        #candidatesList2011.candidate-list
        %hr
        
        %h4.map-2001
          %span#candidatesCount2001
          candidates only in 2001 House District:
          %span#district2001_results
        #candidatesList2001.candidate-list

  .span7
    #map_canvas
    %span.pull-right
      %a{:href => "http://derekeder.com/searchable_map_template/"} Searchable Map Template
      by
      = succeed "." do
        %a{:href => "http://derekeder.com"} Derek Eder

- content_for :javascripts do
  = include_javascript :"jquery.address.min"
  = include_javascript :"http://maps.google.com/maps/api/js?sensor=false"
  %script{:src => "/javascripts/maps_lib.js?3", :type => "text/javascript"}

  :javascript
    $(window).resize(function () {
      var h = $(window).height(),
        offsetTop = 90; // Calculate the top offset
    
      $('#map_canvas').css('height', (h - offsetTop));
    }).resize();
    
    $(function() {
      MapsLib.initialize();

      $(':checkbox').click(function(){
        MapsLib.doSearch();
      });

      $(':radio').click(function(){
        MapsLib.doSearch();
      });
      
      $('#search').click(function(){
        MapsLib.doSearch();
      });
      
      $('#find_me').click(function(){
        MapsLib.findMe(); 
        return false;
      });
      
      $('#reset').click(function(){
        $.address.parameter('address','');
        MapsLib.initialize(); 
        $('#enter_search').show();
        $('#results').hide();
        return false;
      });
      
      $(":text").keydown(function(e){
          var key =  e.keyCode ? e.keyCode : e.which;
          if(key == 13) {
              $('#search').click();
              return false;
          }
      });
    });